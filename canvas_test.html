<!DOCTYPE html>
<html>
  <head>
    <title>
      Redraw
    </title>
    <link rel="stylesheet" href="canvas_navigation_bar.css" />
  </head>
  <body>
    <div class="topnav">
      <a class="active" href="#home">FLS</a>
      <a class="about" href="#About">About</a>
      <a class="help" href="#Help">Help</a>
    </div>

    <div style="display: flex;">
      <div
        id="canvasDivisor"
        style="position: relative; display: inline-block;"
      >
        <canvas
          onclick="krug(event)"
          id="canvas"
          width="800"
          height="400"
          style="border:2px solid #d3d3d3;"
        >
        </canvas>
      </div>
      <div
        style="position: relative; display: inline-block; height: 400px; width: 30%; overflow-y: scroll;"
      >
        <ol></ol>
      </div>
    </div>
  </body>
</html>

<script>
  var lista = [];
  var canvas = document.getElementById("canvas");
  var ctx = canvas.getContext("2d");
  var i = 1;
  var output = "";

  const context = canvas.getContext("2d");

  window.onload = function() {
    var img = new Image();
    img.src =
      "https://raw.githubusercontent.com/html-ninjas/FLS/master/matcropped.jpg";
    img.onload = function() {
      fill_canvas(img);
    };
    function fill_canvas(img) {
      //img.width = canvas.width;
      //img.height = canvas.height;
      console.log(img);
      ctx.globalAlpha = 0.5;
      ctx.drawImage(img, 0, 0, 800, 400);
    }
  };

  function circle(canvasContext, x, y) {
    canvasContext.fillStyle = "yellow";
    canvasContext.beginPath();
    canvasContext.arc(x, y, 5, 0, 2 * Math.PI);
    canvasContext.stroke();
    canvasContext.fill();
  }

  function resize() {
    const width = Math.floor(document.querySelector("body").clientWidth * 0.7);
    const aspect = 2;
    // document.querySelector("canvas").width = width;
    // document.querySelector("canvas").height = width / aspect;
  }
  document.querySelector("body").onresize = resize;
  resize();

  function krug(event) {
    var x = event.x;
    var y = event.y;
    x -= canvasDivisor.offsetLeft;
    y -= canvasDivisor.offsetTop;
    ctx.globalAlpha = 1;
    ctx.fillStyle = "yellow";
    circle(ctx, x, y);
    lista.push([x, y]);

    if (lista.length > 1) {
      context.clearRect(0, 0, canvas.width, canvas.height);
      var img = new Image();
      img.src =
        "https://raw.githubusercontent.com/html-ninjas/FLS/master/matcropped.jpg";
      console.log(img);
      ctx.globalAlpha = 0.5;
      ctx.drawImage(img, 0, 0, 800, 400);

      for (var a = 0; a < lista.length - 1; a++) {
        var element1 = lista[a];
        var element2 = lista[a + 1];
        ctx.globalAlpha = 1;
        console.log(element1, element2, a);
        ctx.moveTo(element1[0], element1[1]);
        ctx.lineTo(element2[0], element2[1]);
        ctx.stroke();
        ctx.fillStyle = "yellow";
        circle(ctx, lista[a][0], lista[a][1]);
        circle(ctx, lista[a + 1][0], lista[a + 1][1]);
      }
    }
    var k = lista[lista.length - 1];
    output += `<li id="a${i}">(${k})</li>`;
    document.querySelector("ol").innerHTML = output;
    i = i + 1;
  }
</script>
